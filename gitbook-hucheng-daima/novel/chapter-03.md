# 第三章 组件之心

统一组件库的提案一出，最大的分歧落在“样式”。

林越摊手：“客户甲要 12px，客户乙要 14px，我们只用一套，行吗？”

“行。”陈砺写下几枚 token：spacing.sm、spacing.md、spacing.lg。又于白板画出两层：其上为主题，其下为组件。“差异入主题，组件只食 token。这叫‘可配置的统一’。”

小齐跃跃欲试：“那我先做两套 CSS？”

“且慢。”陈砺摇头，“做一套 token，余者由主题分流。统一不为快本身，是为把快安在秩序上。”

当夜，他新开一包：@org/design-tokens。README 首行写：勿绕 token 直写样式。

窗外雨歇，风过梧桐。苏棠发来照片：书店新到一册散文，页角压着银杏叶。短句附后：风停了。

# 第三章 组件之心

统一组件库的提案一出，最大的分歧落在“样式”。

林越摊手：“客户甲要 12 px，客户乙要 14 px，我们只用一套，行吗？”

“行。”陈砺写下几枚 token：`spacing.sm`、`spacing.md`、`spacing.lg`。又于白板画两层：其上为主题，其下为组件。“差异入主题，组件只食 token。这叫‘可配置的统一’。”

小齐跃跃欲试：“那我先做两套 CSS？”

“且慢。”陈砺摇头，“做一套 token，余者由主题分流。统一不为快本身，是为把快安在秩序上。”

那一周，他们围绕“按钮”的最小切片打磨到深夜：焦点态、禁用态、危险态、加载态……每一处都写入 token 词典。词典像一张看不见的琴谱，组件按谱而奏。

设计评审上，林越提出“视觉一致与可识别”的平衡点。最后落定：主题允许差异，交互不许随意。

当夜，他新开一包：`@org/design-tokens`。README 首行写：勿绕 token 直写样式。

窗外雨歇，风过梧桐。苏棠发来照片：书店新到一册散文，页角压着银杏叶。短句附后：风停了。

他回以一行：秩序不是枷锁，是让人并肩走的路。

一周后的设计联席会上，外部设计供应商也加入了讨论。对方提出了一套更具观感的渐变与阴影方案，效果确实迷人。小齐看得两眼放光，问能不能直接上。陈砺看了看时间线，说：“短期可以，前提是拉通 token 与主题的映射，不允许在组件内部直写阴影值。”对方设计师有些不满，觉得束手束脚。林越打了个圆场，说：“我们希望把‘好看’变成一套‘可复制的好看’。”

这个会议持续了三个小时。会后，小齐追着陈砺问：“为什么你总是把‘可复制’放在‘好看’前面？”陈砺说：“因为你我会离开，但词典会留下。”小齐又问：“那‘个人的风格’怎么办？”陈砺笑：“写在主题里啊。”

第二天，他们在测试环境里开了一次“色彩可达性演练”。夜间模式、色弱模拟、对比度检查……每一个页面都像一次考试。前两页很顺，第三页就被卡住了：某个红色按钮在深色背景下几乎看不清。设计师说：“这就是我要的深沉感。”陈砺说：“深沉可以，但不能让人看不见。”最终，他们在不牺牲整体风格的前提下，把红色稍稍往橙靠了一些。这个改动被写进了 token：`color.danger.bg.dark` 从 `#8b0000` 变成了 `#a32600`。写完之后，所有页面的“危险按钮”都变得清晰了。

“这就是词典的好处。”陈砺对小齐说。小齐点点头，又问：“那‘提示’和‘警告’呢？现在的黄色在日间看很跳。”他们花了半天时间，为“提示”和“警告”确定了三个亮度的层级，并在主题里做了城市特有的轻微冷暖调整：张江办公室用偏冷的黄，愚园路店里用偏暖的黄。这个决定让设计师也满意，因为它允许“同一座城的不同空间”有自己的气味。

下午，文档站的“组件演示区”上线了第一版。每个组件右上角有一个“雷达图”，显示易用性、灵活性、性能、可达性四个维度的评分。小齐问这是不是有点形式主义。陈砺说：“形式主义也可以成为仪式感。只要它帮我们记住‘为什么这样做’。”

傍晚，他路过会议室，看到一个新来的同学在抄写 token 词典，边抄边小声念：“边距、小、10；边距、中、14；边距、大、18……”像一段温柔的咒语。他停下脚步，忽然明白了一个道理：秩序不是为了控制，而是为了让每一个后来者都能更轻松地参与进来。

夜里，他把今天的调整写进了 ADR：标题是《主题与 token 的双轨》。动机、方案、影响与替代都很短，但他说清楚了两个原则：

1. 在“风格”与“可达性”冲突时，优先可达性；
2. 在“快试验”与“可复制”冲突时，优先可复制。

他知道，并不是每个人都会喜欢这两个原则，但它们会为更多的人，打开一扇门。

第三周，组件库迎来第一个“难缠”的控件——日期选择器。它的复杂不在视觉，而在交互：多端适配、键盘导航、读屏可达性、范围选择的边界处理、跨月滚动的动效与性能均衡。小齐把第一版交上来，用鼠标点击十分顺手，可一到键盘模式就显出“薄弱”：焦点常常迷路。

“把键盘当作第一公民。”陈砺说。他把小齐的实现拆解成几段，示意焦点如何在“日期格子—月份切换—快捷范围”之间以 ARIA 属性明晰地行走。深夜，两人并肩坐在会议室里，灯把桌面照得很白，窗外黑得像没尽头的海。小齐突然说：“我以为‘好用’就是‘点着用得顺手’，原来还要让‘看不见的人也能用’。”陈砺说：“因为我们写的，是‘人的界面’。”

可达性通过后，他们把“日期选择”抽象成“范围选择”的一例，提炼出 `range.start`、`range.end`、`range.quick` 三类 token，配合语义化文案。文案里最难的一句是错误提示：既要明确，又不可斥责。林越把那句写成：“你选择的时间段似乎不完整，我们帮你回到开始。”大家看了都点头。

第四周，供应商再次提出“品牌化”的诉求：他们希望在某些大客户处展示特定的投影与色板，以示“高级感”。会议室里又紧张起来。陈砺拿出一个折中方案：把“品牌主题”作为独立包，以“限定发布”的方式存在，遵守同一套 token 词典，但允许在特定范围内开“白名单”。王序看完方案，给了四个字：“能进能退。”

这段时间，文档站的“组件演示区”不断被填满。每个组件旁边的“雷达图”成了新同学的“入门地图”。有人在评论区留言：“第一次感觉，‘统一’不是为了限制我做什么，而是告诉我‘如何更快地把对的事情做好’。”陈砺把这条留言截图，贴在了文档站的首页。

周末，团队在张江一条风大的路上做了个“小型走查”。每个人只带一台轻薄本和一副耳机，用读屏器从“起步页”走到“日期选择器”的最后一步。途中任何一次卡顿，都要停下来改。走查结束时，夜风把每个人的衣角吹得猎猎作响。小齐有点激动，说：“原来‘词典’也会发出声音。”

那晚，他在 ADR 又加了一条记录：《键盘导航优先级》。很短：

1. 键盘优先；
2. 读屏适配；
3. 光标明确；
4. 失败友好。

写罢，他把电脑合上，长出一口气。窗外有车远远驶过，车灯在窗沿上掠一层光。陈砺忽然想到，有一天他们会把这套组件开源出去。不是为了“星星”，而是因为“让更多人好好用到它”。

第二天早会上，他把“设计 tokens 开源”的提案放到了议题表的第二项。王序问：“为何此时？”陈砺说：“因为我们知道‘为什么这样’，也知道‘如何不再那样’。”房间里短暂地静下来，随后有人轻轻拍了一下桌子，像一声不大却干净的鼓点。
