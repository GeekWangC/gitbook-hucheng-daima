# 第二十七章 洪峰

洪峰来的那天，风像鼓点，雨像弦。指标面板从傍晚开始抬升，流量像潮水从四面八方涌入。办公室里的灯全部亮起，像一片小小的星空。

“Anycast 节点抖动。”江牧盯着图，“北区和华东二在跳。”

他们是不慌的——不是因为风平浪静，而是因为他们练习过。广播员在群里发了第一条消息：

“洪峰到达，方案 A 启动，值守人：@A、@B；回退预案：已准备。”

“自诊断页上线。”小齐远程回，“用户如果遇到问题，会看到三条行动：刷新、切换网络、查看状态页。”

状态页上不是“我们很抱歉”，而是“我们看见了”：

“我们看见某些区域渲染慢。我们正在切换路径，你可以：1）刷新页面；2）切换网络；3）稍后再试。预计 15 分钟内恢复。”

这不是敷衍，是一种诚实。诚实会让焦虑减少，因为焦虑的对手不是坏消息，而是不确定。

在后台，他们打开了自助路径：

- 如果资源加载失败，自动降级到轻版资源；
- 如果渲染超过 800ms，自动切换备用节点；
- 如果用户连续三次失败，触发“联系帮助”，把对话开在用户的节奏里。

两个小时后，雨势稍缓。指标开始回落，状态页的黄灯变绿。有人提议庆功，陈砺摇头。

“写账。”他说。

他们把这次洪峰写成一份“气候报告”：

1. 现象：Anycast 抖动导致 TTFB 抬升 30%，P95 延迟升至 1.3s；
2. 行动：切换路径、降级资源、自诊断页上线；
3. 结果：U7 未见显著下降，客服负面情绪标签下降 18%；
4. 反哺：将自诊断页组件开源，贡献给社区；
5. 复议：三周后评估 Anycast 策略，必要时引入更多探针与策略表。

他们把“自诊断页”整理为开源模板：一句事实、三条行动、一个状态链接。代码很短，注释很长。注释写给人看，告诉后来者为什么写成这样，哪些地方可以改，哪些地方不能动。

两周后，社区有人来提交 PR：“在弱网环境提供一个‘极简模式’。”他们合并了。然后，在知识墙上翻了一张“回流完成”的卡片。

“开源让城市里的路更多。”江牧说，“你以为只有这几条路，结果有人在另一头铺了一条新路过来。”

那晚很晚，他们才离开。雨停了，空气里有一股洗过的味道。走到街角，路灯把水坑照得亮亮的。陈砺忽然想起小时候看洪水的记忆：洪水退去，河床更清楚了。

“洪峰不是敌人。”他对自己说，“洪峰是老师。”

一周后的数据复盘里，他们第一次把“用户自助路径”的细节摊开看：进入状态页后 60 秒内返回产品的比例是多少，看到三条行动后选择“稍后再试”的人明天回来了吗，点击“切换网络”的人在不同运营商下的成功率差异如何。数字像河床上的石头，一颗一颗露了出来。

“我们要留下石头的位置。”陈砺说。

于是，自诊断页加了三个小小的记录点：

1. 用户在第几秒做出选择；
2. 用户是否回访以及何时回访；
3. 成功后是否愿意留下建议。

这些点被写成句子，句子被贴进指标，指标被放到对照板。两周后，他们能在板上清楚地看见，自助路径不是“丢用户”，它是在“托住用户”。托住的不是转化，而是彼此的耐心。

开源项目的 README 里，也多了“证据”的段落。许多开源项目喜欢讲“哲学”，他们偏爱讲“事实”：

“在一次峰值 4 倍于平日的洪峰中，自诊断页使客服工单减少 36%，U7 未见显著下降，点击‘查看状态’的用户在 24 小时内回访率 62%。”

评论区有人问：“你们为什么不在状态页写‘我们很抱歉’？”

“因为我们选择把‘抱歉’换成‘我们已经收到’，这会邀请用户与我们并肩，而不是面对。”

“面对”让人紧绷，“并肩”让人结伴。语言的方向，也是工程的方向。

月底，他们收到第一份来自外部的“流量洪峰报告”。报告来自一个小团队，他们套用了模板，贴上了一组自己的数字，又在最后写了一段故事：某个深夜，一个外包同学在自诊断页里看到了“我们已经收到”，他说自己第一次觉得不是“孤军奋战”。

“这就是开源。”江牧说，“不是代码被复制，而是方法被照亮。”

那天夜里，雨又来了。窗外的树影在路灯下晃动，像一条河在轻轻拐弯。陈砺合上电脑，给状态页的“证据段落”补了一句：

“下一次洪峰，我们会准备更多石头的名字。”

第二天，他们在白板上画了一张“洪峰地图”。地图不是按地理，而是按路径：入口—渲染—资源—回执—完成。每一段下面再画出“风、雨、雾”的天气图例，表示它在不同“气候”下的表现。地图边上挂着五只不同颜色的笔，谁路过都可以在上面补充一笔。到黄昏时，地图已经被画得像一幅城市速写。

“这是我们的地理课和气候课。”陈砺笑。

晚上他走到桥边，河面涨了些。桥洞里传来隐约的人声，有人唱歌，不甚准，却诚恳。他把手插进外套口袋里，想起许多年前，自己也在一场洪峰中手忙脚乱。那时候他以为，力量来自速度；现在他知道，力量来自秩序——来自那些提前写好的句子、提前准备的石头、提前安排的拥抱。

他抬头看了一眼天。云层低低地压着城，风绕过高楼的拐角。手机里弹出一条消息：

“状态页：绿。”

他笑了，把手机塞回口袋，慢慢往家走。洪峰之后的街道有一种奇异的宁静，像大合唱刚刚收尾的那三秒。三秒之后，是掌声；再之后，是散场；再再之后，是回家。方法和人一样，需要被送回家。

在家门口，他停了一下，在门背后的“家庭看板”上加了一个小磁贴：今晚早点睡。苏棠从厨房探出头来，问他：“今天风大吗？”

“大。”他答，“但我们撑住了。”

她点点头，递过来一碗热汤。汤冒着热气，像一条缓慢而坚定的曲线。

几日后，开源仓库的 Issues 里又多了一条：“在弱网环境加一个‘仅文本模式’是否可行？”他们没有急着回答，而是用三句事实回信：
1. 我们看见在 2G 网络下自诊断页加载超过 1.2s；
2. 我们期待在 800ms 内呈现第一条行动；
3. 我们将尝试‘仅文本模式’，并在 72 小时后回到这个问题。

72 小时后，他们回来，给出了一段证据和一行简单的“好结果”。那条 Issue 被关闭之前，来自世界另一端的一个头像点了个赞。陌生的认可像夜风一样吹过走廊，吹动了墙上的卡片。

“洪峰是一堂公共课。”陈砺在分享里写，“我们已经把笔记传阅出去。”

第二天的早会上，广播员照例总结了昨夜的风浪。他最后说了一句：“谢谢昨夜没有被惊醒的每一个你。”屋子里安静了一秒，然后响起了轻轻的笑声。洪峰之后，我们更会珍惜安睡。
\n我们在白板上画了一个笑脸。
\n它让早晨更亮了一点。
\n好的，我们继续。
\n晚安。
\n晚安。
\n好。
\n行。
