# 第十四章 技术债公投

“债多矣，总要先还一笔。”王序将 backlog 贴满一墙，像一堵便签所筑的城。

陈砺请众“公投”：人各十票，投于最碍行之债。得票排定，为前两成立 ADR 与时间盒。

有人疑：“此举会否成了形式？”

“形式，亦是承诺。”陈砺道，“把想法写成记录，把记录化作行动。”

票定，榜首为“单测覆盖自二成至六成”。陈砺沉吟片刻，点头：“自今日，每合必升覆盖；不升不合。”

两周，CI 面板上绿块日渐丰，像春草悄回园中。

“我们把投票理由也记录下来吧。”小齐提出。

“好。”陈砺在每条债务卡片上加了“为何重要”的一栏。有人写“每天多花 10 分钟切环境”；有人写“新同学第一天就卡住”；还有人写“我怕，怕那段代码”。他读到最后一句时，心里一震——恐惧本身，也是技术债。

周会结束前，他把规则又收紧了一点：偿债期内，新增需求必须附带“对债务的影响评估”。林越先愣了两秒，随后点头：“我来把表单加进需求模板里。”

晚饭后他路过苏州河，水面映着松散的光。他想，选择把困难写下来，是一种勇敢；选择在系统里为勇敢留位置，是另一种。

# 第十四章 技术债公投

“债多矣，总要先还一笔。”王序将 backlog 贴满一墙，像一堵便签所筑的城。

陈砺请众“公投”：人各十票，投于最碍行之债。得票排定，为前两成立 ADR 与时间盒。

有人疑：“此举会否成了形式？”

“形式，亦是承诺。”陈砺道，“把想法写成记录，把记录化作行动。”

票定，榜首为“单测覆盖自二成至六成”。陈砺沉吟片刻，点头：“自今日，每合必升覆盖；不升不合。”

两周，CI 面板上绿块日渐丰，像春草悄回园中。

第三周，他们迎来了“绿块危机”——覆盖率上去了，测试却开始“偶发失败”。小齐抱怨：“绿得像一片草原，却一脚踩空。”陈砺把大家叫到会议室，开了“Flaky Test 战室”。战室的规则只有两条：

1. 不把“偶发失败”视作“偶然”；
2. 把“为什么会偶发”写成三句：环境、时间、顺序。

他们从最小的一例开始：某个依赖时间精度的测试，在夜间会出现毫秒级的漂移。解决方法很简单：固定时区与时间源。再往下，是并发下的竞态；再往下，是第三方服务的速率限制。每修掉一处，他们就在“债墙”上贴一张小小的“已还”。一个月后，债墙从“红色的海”变成“绿点的图”。

第四周，林越提议做“债务周报”。周报不是“我们做了很多”，而是“我们决定不做什么”。第一期周报写：

- 不再接受“为某一客户单独修改组件内部逻辑”的需求；
- 不再接受“绕开 token 直接写样式”的临时方案；
- 不再接受“为了演示好看而隐藏错误”的请求。

有人担心“周报太硬”。陈砺说：“硬不是拒绝，是边界。边界清楚了，协作反而轻。”

那段时间，他们把“覆盖率提升”做成了三个层级：先从 20% 到 40%，再从 40% 到 55%，最后从 55% 到 60% 以上。每一个层级都有“关键行为”的清单：把“数据工厂”写好；把“可读的数据样本”写成常量；把“不可重复的过程”重构为可注入的依赖。小齐写完第三个层级的时候，发现自己不再害怕“写测试”，反而开始享受“把问题缩小”的过程。

第五周，陈砺把“技术债公投”的过程写成了一份“债务治理指南”。指南里最重要的一页，是“何时该停下”。他写：

1. 当你在短时间内看不到“对别人”的价值时，停下；
2. 当你为了“漂亮的数字”想去做“看不见的牺牲”时，停下；
3. 当你把“忍受”当成“方法”时，停下。

指南发布后，评论区里有人留了一句：“谢谢你们把‘不做’写成一种能力。”

月末的傍晚，风从窗外吹进来，便签墙猎猎作响。陈砺把最后一张“已还”贴在墙角。墙面不再耀眼，却看得人心里踏实。小齐问：“我们还会再欠吗？”陈砺说：“会。债务不是耻辱，长期不还才是。我们会在每次合并时，向前迈一步。”

他说完，窗外的天色已经深了。灯在玻璃幕墙上排成无数小点，像一张正在被修复的网。他知道，明天还有债可还，但今晚可以睡一个好觉。

第六周，他们设立了“债务退休日”。每月最后一个周五，下午四点到六点，只做一件事：把“已还”的债务写成简短的案例，贴到“知识墙”上。知识墙不是为了好看，而是为了让后来的人能在五分钟内明白“我们为什么这样做、我们如何做到、我们如何不再”。

“Flaky Test 战室”继续开，但频率慢慢降了下来。韩舟成了“战室队长”。他讲话不多，但每讲一句都落在点上。他把“偶发失败”的判定写成了三段脚本；把“重跑通过”的错觉写成了“危险指标”。某次复盘，他写下四个字：重跑不是治愈。大家哄笑，他也笑，笑里有一点得意。

那天傍晚，陈砺站在窗前，看着风把便签墙吹得猎猎。他忽然想到一个更长的尺度：技术债务不会消失，它会换形。他们所能做的，是让它以“可管理的形状”存在。他把这个念头写进了 ADR 的“未尽”一栏：债务不是一次性的清偿，而是长期的治理。治理需要边界，也需要耐心。

第七周，他们为“债务治理”设立了一个小小的“评分卡”。评分卡不打人，只打事。每一条“已还”，都要写出“对他人的帮助”。有一次，一个看起来很琐碎的“删除无用代码”的 PR 得分最高，因为它让两个组的新同学都少走了弯路。小齐在群里感叹：“原来‘小事’也可以有很大的光。”

第八周，覆盖率从 58% 抬到 62%。陈砺在“知识墙”前停了一会儿，想起第一次把“覆盖率从 20% 提到 60%”写成“榜首”的那天。那时他只看见“数字”，现在他看见“人”。数字是结果，人是原因。把原因照顾好，结果会自己来。

第九周，他们把“债务治理”与“演练&剧本”串成了一条更长的链。链的开头是“发现坏味道”，中间是“写成记录并复述给后来的人”，结尾是“演练里再过一遍”。这一链路第一次跑完的时候，白板上写了六个字：慢，且持续地快。陈砺看着那六个字，笑了笑。他知道，这不是一个漂亮的口号，而是一句被练过的话。
